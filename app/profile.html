<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/css/bootstrap-datepicker3.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.3.2/main.min.css">
    <link href='https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.1/css/all.css' rel='stylesheet'>
    <link href="https://cdn.jsdelivr.net/gh/LikaloLLC/tourguide.js@0.2.0/tourguide.css" rel="stylesheet">
    
    <title>Profile | ProjectQuest</title>

    <!-- Favicons -->
    <link href="assets/img/favicon.ico" rel="icon">
    
    <style>
        body {
            background-image: url("../assets/bg.jpg");
            background-size: cover;
            background-repeat: no-repeat;
        }

        #tasks {
            height: 100%;
            margin-bottom: 80px;
        }

        #exp {
            margin-top: -15px;
        }

        #lvl {
            margin-top: -15px;
        }

        #ch-container {
            width: 80%;
        }

        .fc-daygrid-day {
            padding: 40px;
            background-color: #fff2d6;
        }

        #ch-window {
            width: 100%;
            height: 100%;
            border: 5px solid #a8c582;
            background: url("../assets/ch-bg.png") repeat-x right center;
            background-size: 150px;
            -webkit-animation: displace 10s linear infinite;
            animation: displace 10s linear infinite;
        }

        @-webkit-keyframes displace {

            from {
                background-position: 200% center;
            }

            to {
                background-position: right center;
            }


        }

        @keyframes displace {
            from {
                background-position: 200% center;
            }

            to {
                background-position: right center;
            }
        }


        #ch-img {
            width: 100px;
            margin-top: 10px;
            margin-left: 10px;
        }

        #demon {
            width: 110px;
            margin-top: 10px;
            margin-left: 100px;
        }

        #lvl-container {
            width: 150px;
            padding: 0px;
        }

        #lvl-window {
            border: 5px solid #a8c582;
            border-right: none;
        }

        .table {
            background-color: white;
        }


        @media (max-width: 767.98px) {

            #demon {
                margin-left: 20px;
            }

            #ch-window {
                width: 100%;
                height: 100%;
                border: 5px solid #a8c582;
                background: url("../assets/ch-bg.png") repeat-x right center;
                background-size: 150px;
                -webkit-animation: displace 10s linear infinite;
                animation: displace 3s linear infinite;
            }
        }

        #snackbar {
            visibility: hidden;
            min-width: 250px;
            margin-left: -125px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 2px;
            padding: 16px;
            position: fixed;
            z-index: 1;
            left: 50%;
            bottom: 30px;
            font-size: 17px;
        }

        #snackbar.show {
            visibility: visible;
            -webkit-animation: fadein 0.5s, fadeout 0.5s 2.5s;
            animation: fadein 0.5s, fadeout 0.5s 2.5s;
        }

        @-webkit-keyframes fadein {
            from {
                bottom: 0;
                opacity: 0;
            }

            to {
                bottom: 30px;
                opacity: 1;
            }
        }

        @keyframes fadein {
            from {
                bottom: 0;
                opacity: 0;
            }

            to {
                bottom: 30px;
                opacity: 1;
            }
        }

        @-webkit-keyframes fadeout {
            from {
                bottom: 30px;
                opacity: 1;
            }

            to {
                bottom: 0;
                opacity: 0;
            }
        }

        @keyframes fadeout {
            from {
                bottom: 30px;
                opacity: 1;
            }

            to {
                bottom: 0;
                opacity: 0;
            }
        }

        input:disabled,
        select:disabled {
            background-color: white !important;
            color: black;
        }

        .card {
            transition: 0.4s;
            padding: 30px;
        }

        .card:hover {
            -webkit-box-shadow: 1px 9px 16px -3px rgba(0, 0, 0, 0.36);
            -moz-box-shadow: 1px 9px 16px -3px rgba(0, 0, 0, 0.36);
            box-shadow: 1px 9px 16px -3px rgba(0, 0, 0, 0.36);
            transition: 0.4s;
        }

        .card-img-top {
            width: auto;
            height: 100px !important;
        }

        #ch-img {
            width: 100px;
            margin-top: 10px;
            margin-left: 10px;
        }

        #attackModal .modal-body {
            background-image: url("../assets/wall.png");
            height: 200px;
        }

        #attack {
            position: absolute;
            left: 50%;
            z-index: 100;
        }

        #demon2 {
            position: absolute;
            left: 50%;
        }

        #task-complete {
            color: white;
            width: 40%;
            position: absolute;
            top: 80px;
            left: 50px;
        }

        

        @media (max-width: 767.98px) {

            .date {
                font-size: 10px;
            }

            .page-todo {
                margin-left: -20%;
            }

            .tasks {
                width: 150% ;
                margin-left: -50%;
            }

            #attack {
                position: absolute;
                left: 35%;
                z-index: 100;
            }

            #demon2 {
                position: absolute;
                left: 35%;
            }

            #task-complete {
                z-index: 10000;
            }
        }

        .page-todo .tasks {
            background: #fdf4df;
            padding: 0;
            border-right: 1px solid #d1d4d7;
            margin: -30px 15px -30px -15px
        }

        .page-todo .task-list {
            padding: 30px 15px;
            height: 100%
        }

        .page-todo .graph {
            height: 100%
        }

        .page-todo .priority.high {
            background: #fffdfd;
            margin-bottom: 1px
        }

        .page-todo .priority.high span {
            background: #f86c6b;
            padding: 2px 10px;
            color: #fff;
            display: inline-block;
            font-size: 12px
        }

        .page-todo .priority.medium {
            background: #fff0ab;
            margin-bottom: 1px
        }

        .page-todo .priority.medium span {
            background: #f8cb00;
            padding: 2px 10px;
            color: #fff;
            display: inline-block;
            font-size: 12px
        }

        .page-todo .priority.low {
            background: #cfedda;
            margin-bottom: 1px
        }

        .page-todo .priority.low span {
            background: #4dbd74;
            padding: 2px 10px;
            color: #fff;
            display: inline-block;
            font-size: 12px
        }

        .page-todo .task {
            border-bottom: 1px solid #e4e5e6;
            margin-bottom: 1px;
            position: relative
        }

        .page-todo .task .desc {
            display: inline-block;
            width: 75%;
            padding: 10px 10px;
            font-size: 12px
        }

        .page-todo .task .desc .title {
            font-size: 18px;
            margin-bottom: 5px
        }

        .page-todo .task .time {
            display: inline-block;
            width: 25%;
            padding: 10px 10px 10px 0;
            font-size: 12px;
            text-align: right;
            position: absolute;
            top: 0;
            right: 0
        }

        .page-todo .task .time .date {
            font-size: 18px;
            margin-bottom: 5px
        }

        .page-todo .task.last {
            border-bottom: 1px solid transparent
        }

        .page-todo .task.high {
            border-left: 2px solid #f86c6b
        }

        .page-todo .task.medium {
            border-left: 2px solid #f8cb00
        }

        .page-todo .task.low {
            border-left: 2px solid #4dbd74
        }

        .page-todo .timeline {
            width: auto;
            height: 100%;
            margin: 20px auto;
            position: relative
        }

        .page-todo .timeline:before {
            position: absolute;
            content: '';
            height: 100%;
            width: 4px;
            background: #d1d4d7;
            left: 50%;
            margin-left: -2px
        }

        .page-todo .timeslot {
            display: inline-block;
            position: relative;
            width: 100%;
            margin: 5px 0
        }

        .page-todo .timeslot .task {
            position: relative;
            width: 44%;
            display: block;
            border: none;
            -webkit-box-sizing: content-box;
            -moz-box-sizing: content-box;
            box-sizing: content-box
        }

        .page-todo .timeslot .task span {
            border: 2px solid #63c2de;
            background: #e1f3f9;
            padding: 5px;
            display: block;
            font-size: 11px
        }

        .page-todo .timeslot .task span span.details {
            font-size: 16px;
            margin-bottom: 10px
        }

        .page-todo .timeslot .task span span.remaining {
            font-size: 14px
        }

        .page-todo .timeslot .task span span {
            border: 0;
            background: 0 0;
            padding: 0
        }

        .page-todo .timeslot .task .arrow {
            position: absolute;
            top: 6px;
            right: 0;
            height: 20px;
            width: 20px;
            border-left: 12px solid #63c2de;
            border-top: 12px solid transparent;
            border-bottom: 12px solid transparent;
            margin-right: -18px
        }

        .page-todo .timeslot .task .arrow:after {
            position: absolute;
            content: '';
            top: -12px;
            right: 3px;
            height: 20px;
            width: 20px;
            border-left: 12px solid #e1f3f9;
            border-top: 12px solid transparent;
            border-bottom: 12px solid transparent
        }

        .page-todo .timeslot .icon {
            position: absolute;
            border: 2px solid #d1d4d7;
            background: #2a2c36;
            -webkit-border-radius: 50em;
            -moz-border-radius: 50em;
            border-radius: 50em;
            height: 30px;
            width: 30px;
            top: 0;
            left: 50%;
            margin-left: -17px;
            color: #fff;
            font-size: 14px;
            line-height: 30px;
            text-align: center;
            text-shadow: none;
            z-index: 2;
            -webkit-box-sizing: content-box;
            -moz-box-sizing: content-box;
            box-sizing: content-box
        }

        .page-todo .timeslot .time {
            background: #d1d4d7;
            position: absolute;
            -webkit-border-radius: 4px;
            -moz-border-radius: 4px;
            border-radius: 4px;
            top: 1px;
            left: 50%;
            padding: 5px 10px 5px 40px;
            z-index: 1;
            margin-top: 1px
        }

        .page-todo .timeslot.alt .task {
            margin-left: 56%;
            -webkit-box-sizing: content-box;
            -moz-box-sizing: content-box;
            box-sizing: content-box
        }

        .page-todo .timeslot.alt .task .arrow {
            position: absolute;
            top: 6px;
            left: 0;
            height: 20px;
            width: 20px;
            border-left: none;
            border-right: 12px solid #63c2de;
            border-top: 12px solid transparent;
            border-bottom: 12px solid transparent;
            margin-left: -18px
        }

        .page-todo .timeslot.alt .task .arrow:after {
            top: -12px;
            left: 3px;
            height: 20px;
            width: 20px;
            border-left: none;
            border-right: 12px solid #e1f3f9;
            border-top: 12px solid transparent;
            border-bottom: 12px solid transparent
        }

        .page-todo .timeslot.alt .time {
            top: 1px;
            left: auto;
            right: 50%;
            padding: 5px 40px 5px 10px
        }

        @media only screen and (min-width:992px) and (max-width:1199px) {

    

            .page-todo .task .desc {
                display: inline-block;
                width: 70%;
                padding: 10px 10px;
                font-size: 12px
            }

            .page-todo task .desc .title {
                font-size: 16px;
                margin-bottom: 5px
            }

            .page-todo task .time {
                display: inline-block;
                float: right;
                width: 20%;
                padding: 10px 10px;
                font-size: 12px;
                text-align: right
            }

            .page-todo task .time .date {
                font-size: 16px;
                margin-bottom: 5px
            }
        }

        @media only screen and (min-width:768px) and (max-width:991px) {

            .meeting-row button {
                margin-top: 10px;
            }

            .page-todo .task {
                margin-bottom: 1px
            }

            .page-todo .task .desc {
                display: inline-block;
                width: 65%;
                padding: 10px 10px;
                font-size: 10px;
                margin-right: -20px
            }

            .page-todo .task .desc .title {
                font-size: 14px;
                margin-bottom: 5px
            }

            .page-todo .task .time {
                display: inline-block;
                float: right;
                width: 25%;
                padding: 10px 10px;
                font-size: 10px;
                text-align: right
            }

            .page-todo .task .time .date {
                font-size: 14px;
                margin-bottom: 5px
            }

            .page-todo .timeslot .task span {
                padding: 5px;
                display: block;
                font-size: 10px
            }

            .page-todo .timeslot .task span span {
                border: 0;
                background: 0 0;
                padding: 0
            }

            .page-todo .timeslot .task span span.details {
                font-size: 14px;
                margin-bottom: 0
            }

            .page-todo .timeslot .task span span.remaining {
                font-size: 12px
            }
        }
        

        @media  (max-width:767px) {

            .meeting-row button {
                margin-top: 10px;
            }

            .task-list h1 {
                font-size: 25px;
            }

            .task-list blockquote {
                font-size: 15px;
            }

            .page-todo .tasks {
                position: relative;
                margin: 0 !important
            }

            .page-todo .graph {
                position: relative;
                margin: 0 !important
            }

            .page-todo .task {
                margin-bottom: 1px
            }

            .page-todo .task .desc {
                display: inline-block;
                width: 65%;
                padding: 10px 10px;
                font-size: 10px;
                margin-right: -20px
            }

            .page-todo .task .desc .title {
                font-size: 14px;
                margin-bottom: 5px
            }

            .page-todo .task .time {
                display: inline-block;
                float: right;
                width: 25%;
                padding: 10px 10px;
                font-size: 10px;
                text-align: right
            }

            .page-todo .task .time .date {
                font-size: 10px;
                margin-bottom: 5px
            }

            .page-todo .timeslot .task span {
                padding: 5px;
                display: block;
                font-size: 10px
            }

            .page-todo .timeslot .task span span {
                border: 0;
                background: 0 0;
                padding: 0
            }

            .page-todo .timeslot .task span span.details {
                font-size: 14px;
                margin-bottom: 0
            }

            .page-todo .timeslot .task span span.remaining {
                font-size: 12px
            }
        }
    </style>
</head>

<body>

    <div id="tasks">

        <!-- NAVBAR -->
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand" href="./tasks.html">ProjectQuest</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <!-- <li class="nav-item ">
                        <a class="nav-link" href="./home.html">Home <span class="sr-only">(current)</span></a>
                    </li> -->
                    <li class="nav-item ">
                        <a class="nav-link" href="./tasks.html">Tasks </a>
                    </li>
                    <li class="nav-item ">
                        <a class="nav-link" href="./team.html">Team </a>
                    </li>
                    <li class="nav-item ">
                        <a class="nav-link active" href="./profile.html">Profile</a>
                    </li>
                    <li class="nav-item ">
                      <a class="nav-link" href="./rewards.html">Rewards</a>
                  </li>
                </ul>
                
                <ul class='navbar-nav ml-auto' id='logoutDiv'>
                    <li class="nav-item m-1">
                        <a class="btn btn-primary" v-on:click="startTour">Tour</a>
                    </li>
                    <li class="nav-item m-1">
                        <a class="btn btn-secondary" v-on:click="logout">Logout</a>
                    </li>
                </ul>
                
            </div>
        </nav>

        <!-- Generate meeting invite modals -->
        <div v-for="(meeting, index) in upcoming_meetings.meetings">
            <div class="modal fade" v-bind:id="meeting.html_modal_id" tabindex="-1" role="dialog"
                aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Copy Meeting Invite</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            Meeting Invite <br>
                            <textarea readonly v-bind:id="meeting.html_textarea_id"
                                style="width: 100%; padding: 10px;"
                                rows="8">{{meeting["organizer"]}} would like to invite you to a scheduled video meeting. &#13;&#10;&#13;&#10;Topic: {{meeting["name"]}}&#13;&#10;Start Time: {{meeting["start"]}}&#13;&#10;End Time: Time: {{meeting["end"]}}&#13;&#10;&#13;&#10;Join Daily.co meeting:&#13;&#10;{{meeting["room_link"]}}</textarea>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <button type="button" v-on:click="copyInvite(meeting.html_textarea_id)"
                                class="btn btn-primary">Copy Message Invite</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Snackbar -->
        <div id="snackbar">Copied to clipboard!</div>

        <div class="modal fade" id="modTaskModal" tabindex="-1" role="dialog" aria-labelledby="modTaskModal"
            aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Task Details</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1">Task Name</span>
                                </div>
                                <input disabled v-model="chosenTask.taskName" type="text" class="form-control"
                                    placeholder="Name" aria-label="Username" aria-describedby="basic-addon1">
                            </div>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1">Category</span>
                                </div>
                                <input disabled v-model="chosenTask.category" type="text" class="form-control"
                                    placeholder="Name" aria-label="Username" aria-describedby="basic-addon1">
                            </div>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1">Start Date</span>
                                </div>
                                <input disabled v-model="chosenTask.start" type="text" class="form-control" id="date"
                                    name="date" placeholder="MM/DD/YYY" aria-label="Username"
                                    aria-describedby="basic-addon1">
                            </div>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1">End Date</span>
                                </div>
                                <input disabled v-model="chosenTask.end" type="text" class="form-control" id="date"
                                    name="date" placeholder="MM/DD/YYY" aria-label="Username"
                                    aria-describedby="basic-addon1">
                            </div>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <label class="input-group-text" for="inputGroupSelect01">Priority</label>
                                </div>
                                <select disabled v-model="chosenTask.priority" class="custom-select"
                                    id="inputGroupSelect01">
                                    <option value="low">Low</option>
                                    <option value="medium">Medium</option>
                                    <option value="high">High</option>
                                </select>
                            </div>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <label class="input-group-text" for="inputGroupSelect01">Assigned To</label>
                                </div>
                                <select disabled v-model="chosenTask.assignedTo" class="custom-select" multiple
                                    id="inputGroupSelect01">
                                    <option v-for="user in guild.users" v-bind:id="user[1]" v-bind:value="user[1]">
                                        {{user[0]}}</option>
                                </select>
                            </div>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1">Dependency</span>
                                </div>
                                <select disabled v-model="chosenTask.dependency" class="custom-select"
                                    id="inputGroupSelect01">
                                    <option value="none">None</option>
                                    <option v-for="task in tasks.tasks" v-bind:id="task['id']"
                                        v-bind:value="task['id']">{{task["name"]}}
                                        [{{new Date(task["end"]).toLocaleDateString()}}]</option>
                                </select>
                            </div>

                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="attackModal" tabindex="-1" role="dialog" aria-labelledby="attackModal"
            aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-body">
                        <div id="task-complete">
                            <h4>Task Completed! Great job!</h4>
                        </div>
                        <canvas id="attack" width="150" height="150"></canvas>
                        <canvas id="demon2" width="150" height="150"></canvas>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-success" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- CHANGE PASSWORD MODAL -->
        <div class="modal fade" id="passwordModal" tabindex="-1" role="dialog" aria-labelledby="passwordModal"
            aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class='modal-header'>
                        <h5 class="modal-title" id="exampleModalLabel">Change your password</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group row" style='background: none'>
                            <label for="password" class="col-sm-2 col-form-label">Current Password:</label>
                            <div class="col-sm-10">
                                <input type="password" class="form-control" id="currpassword" v-model='change.currpassword'
                                    placeholder="Current password">
                            </div>
                        </div>

                        <div class="form-group row" style='background: none'>
                            <label for="password" class="col-sm-2 col-form-label">New Password:</label>
                            <div class="col-sm-10">
                                <input type="password" class="form-control" id="newpassword" v-model='change.newpassword'
                                    placeholder="New password" v-on:keyup='validatePassword'>
                                    <div class='text-danger' v-if='change.fieldValidations.length > 0'>
                                        <span>Please ensure that your password has:</span>
                                        <ul>
                                            <li v-for='validation in change.fieldValidations'>{{validation}}</li>
                                        </ul>
                                    </div>
                            </div>
                        </div>

                        <div class="form-group row" style='background: none'>
                            <label for="password" class="col-sm-2 col-form-label">Confirm New Password:</label>
                            <div class="col-sm-10">
                                <input type="password" class="form-control" id="cfmpassword" v-model='change.cfmpassword'
                                    placeholder="Repeat new password" @blur="checkSame">
                                    <span v-if="change.notSame" class='text-danger'>Passwords do not match</span>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal" @click='clearFields'>Close</button>
                        <button type="button" class="btn btn-primary" @click='changePassword'>Change password</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- PASSWORD CHANGE SUCCESS MODAL -->
        <div class="modal fade" id="successPw" tabindex="-1" role="dialog" aria-labelledby="successPw"
            aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-body text-center">
                            <h4>Password Changed!</h4>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- PASSWORD CHANGE FAILURE MODAL -->
        <div class="modal fade" id="failurePw" tabindex="-1" role="dialog" aria-labelledby="failurePw"
            aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-body text-center">
                            <h4>Please check your input fields again!</h4>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal" @click='openPasswordModal'>Close</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- MAIN CONTENT -->
        <div class="container" style="height: 100%;">
            <br>

            <div class="row justify-content-md-center">
                <!-- CHARACTER INFO CONTAINER -->
                <div class="col-lg-2 text-center py-3" id="lvl-window">
                    <h3 class="font-weight-bold">Hi {{ this.user.username }}!</h3>
                    <a class="btn btn-primary" @click='openPasswordModal'>Change Password</a>
                </div>
                <!-- CHARACTER RUNNING CONTAINER -->
                <div class="col-lg-10 p-0">
                    <div class="col" id="ch-window">
                        <canvas id="ch-img" width="150" height="150"></canvas>
                        <canvas id="demon" width="150" height="150"></canvas>
                    </div>
                </div>
            </div>

            <br>

            <div class="row justify-content-md-center p-5">
                <div class="col">
                    <div class="container page-todo bootstrap snippets bootdeys">
                        <div style="max-height: 750px; overflow-y: scroll;" class="tasks">
                            <div class="task-list"  data-tour="step: 1; title: Task List; content: Check all the tasks assigned to you here">
                                <h1>Tasks</h1>
                                <blockquote class="blockquote text-right">
                                    <p class="mb-0">{{ this.quote.text }}</p>
                                    <footer class="blockquote-footer">{{ this.quote.author }}</footer>
                                </blockquote>
                                <div class="priority high"><span>high priority</span></div>
                                <div v-if="tasks.high.length > 0">
                                    <div v-for="task in tasks.high" class="task high">
                                        <div class="desc">
                                            <div class="title">{{ task.name }}</div>
                                            <div><button type="button" v-on:click="openTaskModal(task)"
                                                    class="btn btn-dark badge badge-secondary">Click for more
                                                    details!</button> <button type="button"
                                                    class="btn btn-success badge badge-success" v-on:click="completeTask(task.id)">Complete me!</button>
                                            </div>
                                        </div>
                                        <div class="time">
                                            <div class="date">{{ new Date(task["end"]).toDateString() }}</div>
                                        </div>
                                    </div>
                                </div>
                                <div v-else>
                                    <div class="task">
                                        <div class="desc">
                                            <div>You have no high priority tasks! Good job! &#128077;</div>
                                        </div>
                                    </div>
                                </div>


                                <div class="priority medium"><span>medium priority</span></div>

                                <div v-if="tasks.medium.length > 0">
                                    <div v-for="task in tasks.medium" class="task medium">
                                        <div class="desc">
                                            <div class="title">{{ task.name }}</div>
                                            <div><button type="button" v-on:click="openTaskModal(task)"
                                                    class="btn btn-dark badge badge-secondary">Click for more
                                                    details!</button> <button type="button"
                                                    class="btn btn-success badge badge-success" v-on:click="completeTask(task.id)">Complete me!</button>
                                            </div>
                                        </div>
                                        <div class="time">
                                            <div class="date">{{ new Date(task["end"]).toDateString() }}</div>
                                        </div>
                                        <br>
                                    </div>
                                </div>

                                <div v-else>
                                    <div class="task">
                                        <div class="desc">
                                            <div>You have no medium priority tasks! Good job! &#128077;</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="priority low"><span>low priority</span></div>

                                <div v-if="tasks.low.length > 0">
                                    <div v-for="task in tasks.low" class="task low">
                                        <div class="desc">
                                            <div class="title">{{ task.name }}</div>
                                            <div><button type="button" v-on:click="openTaskModal(task)"
                                                    class="btn btn-dark badge badge-secondary">Click for more
                                                    details!</button> <button type="button"
                                                    class="btn btn-success badge badge-success" v-on:click="completeTask(task.id)">Complete me!</button>
                                            </div>
                                        </div>
                                        <div class="time">
                                            <div class="date">{{ new Date(task["end"]).toDateString() }}</div>
                                        </div>
                                    </div>
                                </div>

                                <div v-else>
                                    <div class="task">
                                        <div class="desc">
                                            <div>You have no low priority tasks! Good job! &#128077;</div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="col" >
                    <div class="container page-todo bootstrap snippets bootdeys">
                        <div class="tasks">
                            <div class="task-list" data-tour="step: 2; title: Completed Tasks; content: Tasks you've marked as complete will go here">
                                <h1>Completed Tasks</h1>

                                <div v-if="tasks.completed.length > 0">
                                    <div v-for="task in tasks.completed" class="task">
                                        <div class="desc">
                                            <div class="title">{{ task.name }}</div>
                                            <div><button type="button" v-on:click="openTaskModal(task)"
                                                    class="btn btn-dark badge badge-secondary">Click for more
                                                    details!</button>
                                            </div>
                                        </div>
                                        <div class="time">
                                            <div class="date">{{ new Date(task["end"]).toDateString() }}</div>
                                        </div>
                                    </div>
                                </div>

                                <div v-else>
                                    <div class="task">
                                        <div class="desc">
                                            <div>You have no completed tasks!<br>What are you waiting for?</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <hr>

            <div class="row justify-content-md-center p-4" data-tour="step: 3; title: Your Meetings; content: Not sure if you have a meeting coming up? Check out all meetings you're supposed to attend here">
                <div class="col-lg-10" id="meeting-list">
                    <div class="container">
                        <div class="row">
                            <h1>Your Meetings</h1>
                            <ul class="w-100 nav nav-fill nav-pills mb-3" id="pills-tab" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" id="pills-upcoming-tab" data-toggle="pill"
                                        href="#pills-upcoming" role="tab" aria-controls="pills-upcoming"
                                        aria-selected="true">Upcoming meetings</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="pills-past-tab" data-toggle="pill" href="#pills-past"
                                        role="tab" aria-controls="pills-past" aria-selected="false">Past meetings</a>
                                </li>
                            </ul>

                            <div class="tab-content w-100" id="pills-tabContent">
                                <div class="tab-pane fade show active" id="pills-upcoming" role="tabpanel"
                                    aria-labelledby="pills-upcoming-tab">
                                    <div v-if="upcoming_meetings.show" class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr class="table-primary">
                                                    <th class="meeting-header-th meeting-row" scope="col">#</th>
                                                    <th class="meeting-header-th meeting-row" scope="col">Start datetime
                                                    </th>
                                                    <th class="meeting-header-th meeting-row" scope="col">Meeting</th>
                                                    <th class="meeting-header-th meeting-row" scope="col">Organizer</th>
                                                    <th class="meeting-header-th meeting-row" scope="col"></th>
                                                </tr>
                                            </thead>
                                            <tbody>

                                                <tr v-for="(meeting, index) in upcoming_meetings.meetings">
                                                    <th class="meeting-row" scope="row">{{index + 1}}</th>
                                                    <td class="meeting-row">{{meeting["start"]}}</td>
                                                    <td class="meeting-row">{{meeting["name"]}}</td>
                                                    <td class="meeting-row">{{meeting["organizer"]}}</td>
                                                    <td class="meeting-row">
                                                        <a v-bind:href="meeting.room_link" target="_blank"
                                                            class="btn btn-success">Join</a>
                                                        <button type="button" class="btn btn-info" data-toggle="modal"
                                                            v-bind:data-target="meeting.html_button_id">Generate
                                                            Invite</button>
                                                    </td>
                                                </tr>

                                            </tbody>
                                        </table>
                                    </div>
                                    <div v-else class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr class="table-primary">
                                                    <th class="meeting-header-th meeting-row" scope="col">#</th>
                                                    <th class="meeting-header-th meeting-row" scope="col">Start datetime
                                                    </th>
                                                    <th class="meeting-header-th meeting-row" scope="col">Meeting</th>
                                                    <th class="meeting-header-th meeting-row" scope="col">Organizer</th>
                                                    <th class="meeting-header-th meeting-row" scope="col"></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td colspan="5" class="text-center meeting-row">You do not have any
                                                        upcoming meetings.</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="pills-past" role="tabpanel"
                                    aria-labelledby="pills-past-tab">

                                    <div v-if="past_meetings.show" class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr class="table-primary">
                                                    <th class="meeting-header-th meeting-row" scope="col">#</th>
                                                    <th class="meeting-header-th meeting-row" scope="col">Start datetime
                                                    </th>
                                                    <th class="meeting-header-th meeting-row" scope="col">End datetime
                                                    </th>
                                                    <th class="meeting-header-th meeting-row" scope="col">Meeting</th>
                                                    <th class="meeting-header-th meeting-row" scope="col">Organizer</th>
                                                </tr>
                                            </thead>
                                            <tbody>

                                                <tr v-for="(meeting, index) in past_meetings.meetings">
                                                    <th class="meeting-row" scope="row">{{index + 1}}</th>
                                                    <td class="meeting-row">{{meeting["start"]}}</td>
                                                    <td class="meeting-row">{{meeting["end"]}}</td>
                                                    <td class="meeting-row">{{meeting["name"]}}</td>
                                                    <td class="meeting-row">{{meeting["organizer"]}}</td>
                                                </tr>

                                            </tbody>
                                        </table>
                                    </div>
                                    <div v-else class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr class="table-primary">
                                                    <th class="meeting-header-th meeting-row" scope="col">#</th>
                                                    <th class="meeting-header-th meeting-row" scope="col">Start datetime
                                                    </th>
                                                    <th class="meeting-header-th meeting-row" scope="col">End datetime
                                                    </th>
                                                    <th class="meeting-header-th meeting-row" scope="col">Meeting</th>
                                                    <th class="meeting-header-th meeting-row" scope="col">Organizer</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td colspan="5" class="text-center meeting-row">You do not have any
                                                        past meetings.</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>


        </div>
    </div>


    <script type="text/javascript" src="http://www.gstatic.com/charts/loader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous">
        </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous">
        </script>
    <script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/js/bootstrap-datepicker.min.js">
        </script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.3.2/main.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.3.2/locales-all.min.js"></script>
    <script src='https://unpkg.com/popper.js/dist/umd/popper.min.js'></script>
    <script src='https://unpkg.com/tooltip.js/dist/umd/tooltip.min.js'></script>
    <script src="https://cdn.jsdelivr.net/gh/LikaloLLC/tourguide.js@0.2.0/tourguide.min.js"></script>
    <script>
        var app = new Vue({
            el: '#tasks',
            data: {
                user: {
                    // loggedInUser: "naruto@wad2.co",
                    loggedInUser: "",
                    username: "",
                    userLevel: "",
                    userExp: "",
                    password: ""
                },
                guild: {
                    // name: "wad2_guild",
                    name: "",
                    streak: "",
                    users: [],
                    reponame: ""
                },
                tasks: {
                    tasks: [],
                    taskName: "",
                    assignedTo: [],
                    start: "",
                    end: "",
                    dependency: "",
                    priority: "",
                    category: "",
                    completed: [],
                    high: [],
                    medium: [],
                    low: []
                },
                chosenTask: {
                    id: "",
                    taskName: "",
                    assignedTo: [],
                    start: "",
                    end: "",
                    dependency: "",
                    priority: "",
                    category: ""
                },
                rewards: [],
                quote: {
                    author: "",
                    text: ""
                },
                meeting: {
                    name: "",
                    attendees: [],
                    start: "",
                    end: "",
                },
                meeting_flag: false,
                upcoming_meetings: {
                    show: true,
                    meetings: []
                },
                past_meetings: {
                    show: true,
                    meetings: []
                },
                change: {
                    currpassword: "",
                    newpassword: "",
                    cfmpassword: "",
                    fieldValidations: [],
                    notSame: false,
                    passwordValid: false
                }
            },
            methods: {
                startTour: function() {
                    var tourguide = new Tourguide();
                    tourguide.start()
                },
                completeTask: function (id) {
                    $("#attackModal").modal("show")
                    fetch("http://localhost:5001/complete_task", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({
                            id: id,
                            email: this.user.loggedInUser
                        })
                    }).then(res => {
                        res.json().then(data => {
                            this.user.userExp = parseInt(data["new_exp"])
                            this.user.userLevel = parseInt(data["new_level"])
                            location.reload()
                        })

                    })
                },
                logout: function () {
                    sessionStorage.clear()
                    window.location.replace("./home.html");
                },
                openTaskModal: function (task) {
                    this.chosenTask = task
                    this.chosenTask.taskName = task.name
                    $('#modTaskModal').modal('show');
                },
                openPasswordModal: function () {
                    $('#passwordModal').modal('show');
                },
                checkSame: function () {
                    if (this.change.newpassword != this.change.cfmpassword) {
                        this.change.notSame = true
                    } else {
                        this.change.notSame = false
                    }
                },
                clearFields: function () {
                    this.change.currpassword = ''
                    this.change.newpassword = ''
                    this.change.cfmpassword = ''
                    this.change.notSame = false
                },
                validatePassword: function () {
                    this.change.fieldValidations = []

                    if (this.change.newpassword.length < 8) {
                        this.change.fieldValidations.push("has more than 8 characters")
                    }

                    var lowerCaseLetters = /[a-z]/g;
                    if (!this.change.newpassword.match(lowerCaseLetters)) {
                        this.change.fieldValidations.push("has lower case letters")
                    }

                    var upperCaseLetters = /[A-Z]/g;
                    if (!this.change.newpassword.match(upperCaseLetters)) {
                        this.change.fieldValidations.push("has upper case letters")
                    }

                    var numbers = /[0-9]/g;
                    if (!this.change.newpassword.match(numbers)) {
                        this.change.fieldValidations.push("has numbers")
                    }

                    var symbols = /[!@#$%^&*]/g;
                    if (!this.change.newpassword.match(symbols)) {
                        this.change.fieldValidations.push("has symbols")
                    }

                    if (this.change.fieldValidations.length < 1) { 
                        this.change.passwordValid = true
                    } else {
                        this.change.passwordValid = false
                    }
                },
                copyInvite: function (inviteId) {
                    var copyText = document.getElementById(inviteId);
                    copyText.select();
                    document.execCommand("copy");
                    //alert("Copied the text: " + copyText.value);
                    var x = document.getElementById("snackbar");
                    x.className = "show";
                    setTimeout(function () { x.className = x.className.replace("show", ""); }, 3000);
                },
                changePassword: function () {
                    if (this.user.password == this.change.currpassword && this.change.passwordValid) {
                        // console.log("hi")
                        fetch("http://localhost:5001/modify_user", {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json"
                            },
                            body: JSON.stringify({
                                email: this.user.loggedInUser,
                                password: this.change.newpassword
                            })
                        }).then(res => {
                            $('#passwordModal').modal('hide');
                            this.user.password = this.change.newpassword
                            $('#successPw').modal('show')
                            this.clearFields()
                        }).catch(e => {
                            // console.log(e);
                            $('#passwordModal').modal('hide');
                            $('#failurePw').modal('show')
                        })
                    } else {
                        $('#passwordModal').modal('hide');
                        $('#failurePw').modal('show')
                    }
                }
            },
            // When Vue view is created, runs the following functions
            async created() {

                if (sessionStorage.getItem("user") !== null) {
                    // Retrieve
                    this.user.loggedInUser = sessionStorage.getItem("user");
                    this.user.username = sessionStorage.getItem("username");
                    this.guild.name = sessionStorage.getItem("guildName");
                    this.tasks.guild = this.guild.name;
                } else {
                    window.location.replace("./login.html");
                }
                // Gets the information of the logged in user
                await fetch("http://localhost:5001/get_user?email=" + this.user.loggedInUser).then(
                    res => {
                        var data = res.json().then(data => {
                            initialiseImage("../assets/" + data["class"] +
                                "_spritesheet.png",
                                "#ch-img", 65, 260, 0, -70);
                            this.user.userLevel = data["level"];
                            this.user.userExp = data["exp"];
                            this.user.token = data["git_token"];
                            this.user.password = data["password"];
                        })
                    })

                // Gets all users in the guild
                var resp = await fetch("http://localhost:5001/get_all_users").then(res => {
                    var data = res.json().then(data => {
                        var user_arr = []
                        for (u of data["users"]) {
                            user_arr.push([u["name"], u["email"], u["guild"]])
                        }
                        this.guild.users = user_arr
                    })

                })

                // Gets all tasks in the guild to display
                await fetch("http://localhost:5001/get_all_tasks?guild=" + this.guild.name).then(
                    res => {
                        var data = res.json().then(data => {

                            var new_tasks = []
                            for (let i of data["tasks"]) {
                                if (i["assignedTo"].includes(this.user.loggedInUser)) {
                                    new_tasks.push(i)
                                }
                            }
                            this.tasks.tasks = new_tasks
                        })
                    })

                // Gets all tasks in the guild to display
                await fetch("http://localhost:5001/get_assigned_tasks?email=" + this.user.loggedInUser).then(
                    res => {
                        var data = res.json().then(data => {
                            this.tasks.completed = data["completed"]
                            this.tasks.high = data["incomplete"]["high"]
                            this.tasks.medium = data["incomplete"]["medium"]
                            this.tasks.low = data["incomplete"]["low"]
                        })
                    })

                // Get quote of the day
                fetch("https://type.fit/api/quotes").then(
                    res => {
                        var data = res.json().then(data => {
                            random_quote = data[Math.floor(Math.random() * data.length)];
                            this.quote.author = random_quote["author"];
                            this.quote.text = random_quote["text"];
                        })
                    })

                // Gets guild info
                await fetch("http://localhost:5001/get_guild?name=" + this.guild.name).then(res => {
                    var data = res.json().then(data => {
                        this.guild.streak = data["streak"]
                        this.guild.reponame = data["r_name"]

                    })
                })

                // Get Rewards
                await fetch("http://localhost:5001/get_rewards_by_guild?guild=" + this.guild.name).then(
                    res => {
                        var data = res.json().then(data => {
                            this.rewards = data["rewards"]
                        })
                    })

                // Load their upcoming meetings
                await fetch("http://localhost:5001/get_upcoming_meetings?email=" + this.user.loggedInUser)
                    .then(res => {
                        var data = res.json().then(data => {
                            if (data["meetings"].length == 0) {
                                this.upcoming_meetings.show = false;
                            } else {
                                this.upcoming_meetings.show = true;
                                for (i = 0; i < data["meetings"].length; i++) {
                                    var new_start = data["meetings"][i]["start"].split(" ")
                                        .slice(0, -1).join(" ");
                                    var new_end = data["meetings"][i]["end"].split(" ").slice(0,
                                        -1).join(" ");

                                    data["meetings"][i]["start"] = new_start;
                                    data["meetings"][i]["end"] = new_end;
                                }
                                this.upcoming_meetings.meetings = data["meetings"];
                            }
                        })
                    });

                // Load their past meetings
                await fetch("http://localhost:5001/get_past_meetings?email=" + this.user.loggedInUser)
                    .then(res => {
                        var data = res.json().then(data => {
                            if (data["meetings"].length == 0) {
                                this.past_meetings.show = false;
                            } else {
                                this.past_meetings.show = true;
                                for (i = 0; i < data["meetings"].length; i++) {
                                    var new_start = data["meetings"][i]["start"].split(" ")
                                        .slice(0, -1).join(" ");
                                    var new_end = data["meetings"][i]["end"].split(" ").slice(0,
                                        -1).join(" ");

                                    data["meetings"][i]["start"] = new_start;
                                    data["meetings"][i]["end"] = new_end;
                                }
                                this.past_meetings.meetings = data["meetings"];
                            }
                        })
                    })



                // Initialises image of bad guys
                initialiseImage("../assets/demon_spritesheet.png", "#demon", 65, 170, 0, -20);
                initialiseImage("../assets/demon_spritesheet.png", "#demon2", 65, 170, 0, -20);
                initialiseAttackImage("../assets/attack_spritesheet.png", "#attack", 0.3, 550, 450, 0,
                    0);

            }

        });


        // Initialise running images
        function initialiseImage(src, query, width, height, x, y) {
            // Create image object
            let img = new Image();
            img.src = src;
            img.onload = function () {
                init();
            };

            // Create canvas and context
            let canvas = document.querySelector(query);
            let ctx = canvas.getContext('2d');

            // set size of image
            const scale = 2.5;
            const scaledWidth = scale * width;
            const scaledHeight = scale * height;

            // Function for Initial state of image
            function init() {
                ctx.drawImage(img, 0, 0, width, height, x, y, scaledWidth, scaledHeight);
            }

            // Function to draw new images based on inputs
            function drawFrame(frameX, frameY, canvasX, canvasY) {
                ctx.drawImage(img, frameX * width, 0, width, height, x, y, scaledWidth, scaledHeight);
            }

            const cycleLoop = [0, 1, 2, 3];
            let currentLoopIndex = 0;
            let frameCount = 0;

            // Request next frame based on cycleloop
            window.requestAnimationFrame(step);

            // Clears old frame and replaces with new frame based on new values
            function step() {
                frameCount++;
                if (frameCount < 15) {
                    window.requestAnimationFrame(step);
                    return;
                }
                frameCount = 0;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                drawFrame(cycleLoop[currentLoopIndex], 0, 0, 0);
                currentLoopIndex++;
                if (currentLoopIndex >= cycleLoop.length) {
                    currentLoopIndex = 0;
                }
                window.requestAnimationFrame(step);
            }
        }

        function initialiseAttackImage(src, query, scale, width, height, x, y) {
            // Create image object
            let img = new Image();
            img.src = src;
            img.onload = function () {
                init();
            };

            // Create canvas and context
            let canvas = document.querySelector(query);
            let ctx = canvas.getContext('2d');

            // set size of image
            const scaledWidth = scale * width;
            const scaledHeight = scale * height;

            // Function for Initial state of image
            function init() {
                ctx.drawImage(img, 0, 0, width, height, x, y, scaledWidth, scaledHeight);
            }

            // Function to draw new images based on inputs
            function drawFrame(frameX, frameY, canvasX, canvasY) {
                ctx.drawImage(img, frameX * width, 0, width, height, x, y, scaledWidth, scaledHeight);
            }

            const cycleLoop = [0, 1, 2, 3];
            let currentLoopIndex = 0;
            let frameCount = 0;

            // Request next frame based on cycleloop
            window.requestAnimationFrame(step);

            // Clears old frame and replaces with new frame based on new values
            function step() {
                frameCount++;
                if (frameCount < 15) {
                    window.requestAnimationFrame(step);
                    return;
                }
                frameCount = 0;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                drawFrame(cycleLoop[currentLoopIndex], 0, 0, 0);
                currentLoopIndex++;
                if (currentLoopIndex >= cycleLoop.length) {
                    currentLoopIndex = 0;
                }
                window.requestAnimationFrame(step);
            }
        }
    </script>
</body>

</html>